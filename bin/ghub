#!/usr/bin/perl

use strict;
use warnings;

$| = 1; # autoflush

my $command = "@ARGV";
my $githome = $ENV{GITHOME} || $ENV{HOME};

$ENV{GITHUBS} or die ("GITHUBS empty");

my @hubs = split(';', $ENV{GITHUBS});

for my $hub (@hubs) {
  if ($command) {
    my $dashes = '-' x ((78-length($hub)-2)/2);
    my $extra = (length($hub)%2) ? '-' : '';
    print "$dashes $hub $dashes$extra\n";
    system "cd $githome; git $command " unless not -d $hub;
  } else {
    print "$hub\n";
  }
}
